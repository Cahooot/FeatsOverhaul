// =================================== Ritual Caster: Free Spells ===================================
// Now reduces cost of learning spells from all scrolls by 50%

new entry "RitualCaster_FreeSpells"
type "PassiveData"
data "DisplayName" "ha96a2d1cgc088g2a1cg4e75g6ccdb09d5c4f;1"
data "Description" "h57970174g63e0g7105g7a50g18460fbff6c1;1"
data "DescriptionParams" "3;2"
data "Icon" "PassiveFeature_RitualCaster_FreeSpells"
data "Properties" "Highlighted"
data "Boosts" "Savant(Enchantment);Savant(Divination);Savant(Necromancy);Savant(Abjuration);Savant(Illusion);Savant(Conjuration);Savant(Transmutation);Savant(Evocation)"

// =================================== Ritual Caster: Freecast ===================================
// New passive to allow user to cast a Ritual spell in combat for free 

new entry "CHT_RitualCaster_Freecast"
type "PassiveData"
data "DisplayName" "haa1b38b0ge8fdg424fgbef2gdc909906eae3;1"
data "Description" "h1dba8c83ge059g43dcg8819gb6c80c138a24;1"
data "Icon" "PassiveFeature_RitualCaster_FreeSpells"
data "Properties" "Highlighted;ToggledDefaultAddToHotbar;IsToggled;OncePerShortRest"
data "EnabledConditions" "Combat() and not HasStatus('CHT_RITUALCASTER_FREECAST_USED')"
data "EnabledContext" "OnCastResolved;OnStatusApplied;OnStatusRemoved"
data "Conditions" "CHT_RitualCasterCheck()"
data "StatsFunctors" ""
data "StatsFunctorContext" ""
data "ToggleOnFunctors" "ApplyStatus(CHT_RITUALCASTER_FREECAST,100,-1);ApplyStatus(CHT_RITUALCASTER_FREECAST_TRACKER,100,-1)"
data "ToggleOffFunctors" "RemoveStatus(CHT_RITUALCASTER_FREECAST);RemoveStatus(CHT_RITUALCASTER_FREECAST_TRACKER)"
data "ToggleOffContext" "OnCastResolved"

// Statuses for the free in-combat Ritual spell cast
new entry "CHT_RITUALCASTER_FREECAST"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hf7816fbcg3181g4275g942fgd9b799dd54e5;1"
data "Description" "hb047ef39g36dfg4dcdg8d57gab5d0c37ccf8;1"
data "Icon" "PassiveFeature_RitualCaster_FreeSpells"
data "StackId" "CHT_RITUALCASTER_FREECAST"
data "Boosts" "UnlockSpellVariant(CHT_RitualCasterCheck(),ModifyIconGlow(),ModifyUseCosts(Replace,SpellSlot,0,-1,SpellSlot),ModifyUseCosts(Replace,SpellSlotsGroup,0,-1,SpellSlotsGroup),ModifyUseCosts(Replace,SpellSlotsGroup,0,-1,SpellSlotsGroup))"
data "StatusPropertyFlags" "DisableCombatlog"
data "StatusGroups" "SG_RemoveOnRespec"

new entry "CHT_RITUALCASTER_FREECAST_TRACKER"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "CHT_RITUALCASTER_FREECAST_TRACKER"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "RemoveEvents" "OnSpellCast"
data "RemoveConditions" "HasStatus('CHT_RITUALCASTER_FREECAST',context.Source)"
data "OnRemoveFunctors" "IF(HasStatus('CHT_RITUALCASTER_FREECAST',context.Source)):ApplyStatus(CHT_RITUALCASTER_FREECAST_USED,100,-1)"

new entry "CHT_RITUALCASTER_FREECAST_USED"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "CHT_RITUALCASTER_FREECAST_USED"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "RemoveConditions" "HasStatus('SHORT_REST')"
data "RemoveEvents" "OnStatusApplied"

// =================================== Ritual Caster: Regain Spell Slot ===================================
// New passive for chance of restoring spell slots when short resting 
// (Done through separate passives because the other RollDieAgainstDC() don't work here if in the same StatsFunctor line for some reason)

new entry "RitualCaster_SpellSlotRestoration_1"
type "PassiveData"
data "DisplayName" "hd9326ba8g3fddg4eb3g90cdg08567cb258a5;1"
data "Description" "hecbd1fbdg8c84g4e7fgb26eg78cefdd70264;1"
data "DescriptionParams" "20;20;20"
data "Icon" "PassiveFeature_RitualCaster_MemorizeSpells"
data "Properties" "Highlighted"
data "StatsFunctorContext" "OnShortRest"
data "StatsFunctors" "IF(RollDieAgainstDC(DiceType.d100,81)):ApplyStatus(SELF,RITUALCASTER_RESTORE_SPELLSLOT_1,100,0)"

new entry "RitualCaster_SpellSlotRestoration_2"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnShortRest"
data "Conditions" "CharacterLevelGreaterThan(4)"
data "StatsFunctors" "IF(RollDieAgainstDC(DiceType.d100,81)):ApplyStatus(SELF,RITUALCASTER_RESTORE_SPELLSLOT_2,100,0)"

new entry "RitualCaster_SpellSlotRestoration_3"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnShortRest"
data "Conditions" "CharacterLevelGreaterThan(11)"
data "StatsFunctors" "IF(RollDieAgainstDC(DiceType.d100,81)):ApplyStatus(SELF,RITUALCASTER_RESTORE_SPELLSLOT_3,100,0)"

// Statuses for Ritual Caster's spell slot restoration
new entry "RITUALCASTER_RESTORE_SPELLSLOT_1"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "WW_RESTORE_SPELLSLOT_ONE"
data "DisplayName" "h79381d39g4175g4182gb7ebg01357380cf46;1"
data "Description" "h07d1c270g2a6bg4624g8cb9g70895217d70d;1"
data "DescriptionParams" "1"
data "Icon" "PassiveFeature_Generic_Magical"
data "StatusPropertyFlags" "DisablePortraitIndicator"
data "OnApplyFunctors" "RestoreResource(SpellSlot,1,1)"

new entry "RITUALCASTER_RESTORE_SPELLSLOT_2"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "WW_RESTORE_SPELLSLOT_2"
data "DisplayName" "h6128a2b4g872bg4641gab3bgf0a37706905f;1"
data "Description" "h07d1c270g2a6bg4624g8cb9g70895217d70d;1"
data "DescriptionParams" "2"
data "Icon" "PassiveFeature_Generic_Magical"
data "StatusPropertyFlags" "DisablePortraitIndicator"
data "OnApplyFunctors" "RestoreResource(SpellSlot,1,2)"

new entry "RITUALCASTER_RESTORE_SPELLSLOT_3"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "WW_RESTORE_SPELLSLOT_3"
data "DisplayName" "h3cbf0a6bg30b1g4de5g9f05gcf10702f7891;1"
data "Description" "h07d1c270g2a6bg4624g8cb9g70895217d70d;1"
data "DescriptionParams" "3"
data "Icon" "PassiveFeature_Generic_Magical"
data "StatusPropertyFlags" "DisablePortraitIndicator"
data "OnApplyFunctors" "RestoreResource(SpellSlot,1,3)"

// Ability score improvements through passives
new entry "RitualCaster_Intelligence"
type "PassiveData"
data "DisplayName" "h0b8bc8c06bff441a9bd32f24190d2f0eg133;1"
data "Description" "h8ca4cd6297974b05b8090499b5594e41ec7a;1"
data "DescriptionParams" "1"
data "Icon" "GenericIcon_Intent_Buff"
data "Properties" "IsHidden"
data "Boosts" "Ability(Intelligence, 1)"

new entry "RitualCaster_Wisdom"
type "PassiveData"
data "DisplayName" "h7a6eb19d4bd242de8d9da9f2d44b082642c1;1"
data "Description" "h59c91e86fb5841c69b5bf1a6c5d1d41c20e6;1"
data "DescriptionParams" "1"
data "Icon" "GenericIcon_Intent_Buff"
data "Properties" "IsHidden"
data "Boosts" "Ability(Wisdom, 1)"

new entry "RitualCaster_Charisma"
type "PassiveData"
data "DisplayName" "h82e4a645d14b4cee9e1c44717d8cb420725b;1"
data "Description" "h8390214773f14ca0948786c0cab9b8c9e7g9;1"
data "DescriptionParams" "1"
data "Icon" "GenericIcon_Intent_Buff"
data "Properties" "IsHidden"
data "Boosts" "Ability(Charisma, 1)"
